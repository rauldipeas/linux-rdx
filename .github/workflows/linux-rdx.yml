name: Compilação do kernel Linux RDX
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Liberação de espaço em disco
        run: |
          df -h
          sudo apt autoremove --purge -y azure-cli '^dotnet-.*' firefox google-chrome-stable google-cloud-sdk hhvm '^llvm-.*' powershell snapd
          sudo apt clean
          sudo swapoff -a
          sudo rm -rf "$AGENT_TOOLSDIRECTORY" /opt/az /swapfile /usr/share/dotnet /usr/local/share/boost
          df -h
      - name: Compilação do kernel
        run: bash ./build.sh
      - name: Upload dos pacotes para o lançamento
        uses: meeDamian/github-release@2.0
        with:
          token: ${{ secrets.GH_TOKEN }}
          tag: v6.0.2
          name: Linux RDX
          files: ./*.deb
          gzip: false
          allow_override: true
          body: >
            Lorem ipsum dolor sit amet, consectetur adipiscing elit.
            Etiam eget ligula eu lectus lobortis condimentum.
            Aliquam nonummy auctor massa.
            Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.
            Nulla at risus.
            Quisque purus magna, auctor et, sagittis ac, posuere eu, lectus.
            Nam mattis, felis ut adipiscing.